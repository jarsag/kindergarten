{% extends 'base.html' %}
{% block body_class %}gallery-page{% endblock %}

{% block title %}Галерея - Детский сад "Солнышко"{% endblock %}

{% block content %}
<h1 class="mb-4">Галерея наших мероприятий</h1>

<!-- Категории галереи -->
<div class="card kid-friendly mb-4">
    <div class="card-body">
        <h3 class="card-title mb-4"><i class="fas fa-images text-primary"></i> Категории фотографий</h3>
        <div class="row">
            {% for category in categories %}
            <div class="col-md-4 mb-3">
                <a href="{{ category.get_absolute_url }}" class="text-decoration-none">
                    <div class="card clickable-card h-100">
                        {% if category.cover_image %}
                        <img src="{{ category.cover_image.url }}" class="card-img-top" alt="{{ category.name }}" 
                             style="height: 180px; object-fit: cover;">
                        {% else %}
                        <div class="card-img-top bg-light d-flex align-items-center justify-content-center" 
                             style="height: 180px;">
                            <i class="fas fa-camera fa-3x text-warning"></i>
                        </div>
                        {% endif %}
                        <div class="card-body">
                            <h5 class="card-title text-dark">{{ category.name }}</h5>
                            <p class="card-text text-muted small">{{ category.description|truncatechars:80 }}</p>
                        </div>
                        <div class="card-footer bg-transparent">
                            <small class="text-muted">
                                <i class="fas fa-photo-video"></i> {{ category.photo_count }} фото
                            </small>
                        </div>
                    </div>
                </a>
            </div>
            {% empty %}
            <div class="col-12">
                <p class="text-center text-muted">Категории пока не добавлены</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Последние фотографии -->
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-3"><i class="fas fa-history text-success"></i> Последние добавленные</h3>
    </div>
    {% for photo in latest_photos %}
    <div class="col-md-3 col-sm-6 mb-3">
        <a href="{{ photo.get_absolute_url }}" class="text-decoration-none">
            <div class="card clickable-card">
                <img src="{{ photo.image.url }}" class="card-img-top" alt="{{ photo.title }}" 
                     style="height: 200px; object-fit: cover;">
                <div class="card-body p-2">
                    <p class="card-text text-dark small mb-0">{{ photo.title|truncatechars:30 }}</p>
                    <small class="text-muted">{{ photo.uploaded_at|date:"d.m.Y" }}</small>
                </div>
            </div>
        </a>
    </div>
    {% empty %}
    <div class="col-12">
        <p class="text-center text-muted">Фотографии пока не добавлены</p>
    </div>
    {% endfor %}
</div>

<!-- Популярные фотографии -->
<div class="card kid-friendly">
    <div class="card-body">
        <h3 class="card-title mb-3"><i class="fas fa-fire text-danger"></i> Самые просматриваемые</h3>
        <div class="row">
            {% for photo in popular_photos %}
            <div class="col-md-4 col-lg-2 col-sm-6 mb-3">
                <a href="{{ photo.get_absolute_url }}" class="text-decoration-none">
                    <div class="position-relative">
                        <img src="{{ photo.image.url }}" class="img-fluid rounded" alt="{{ photo.title }}" 
                             style="height: 150px; width: 100%; object-fit: cover;">
                        <div class="position-absolute bottom-0 end-0 m-2">
                            <span class="badge bg-dark bg-opacity-75">
                                <i class="fas fa-eye"></i> {{ photo.views }}
                            </span>
                        </div>
                    </div>
                </a>
            </div>
            {% empty %}
            <div class="col-12">
                <p class="text-center text-muted">Пока нет популярных фотографий</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Информация о фотосъемке -->
<div class="alert alert-info mt-4">
    <h5><i class="fas fa-info-circle"></i> О нашей галерее</h5>
    <p class="mb-0">
        Все фотографии сделаны нашими воспитателями и профессиональными фотографами. 
        Мы регулярно обновляем галерею после каждого мероприятия. 
        <strong>Родители могут заказать фотографии</strong> через воспитателя группы.
    </p>
</div>

<style>
    .gallery-page .card.clickable-card {
        transition: transform 0.3s;
    }
    
    .gallery-page .card.clickable-card:hover {
        transform: scale(1.03);
    }
    
    .position-relative:hover img {
        opacity: 0.9;
    }
</style>
{% endblock %}